(function(ns){var H = ns;var g,aa=this,k="closure_uid_"+(1E9*Math.random()>>>0),l=0;function ba(a,b,c){return a.call.apply(a.bind,arguments)}function ca(a,b,c){if(!a)throw Error();if(2<arguments.length){var d=Array.prototype.slice.call(arguments,2);return function(){var c=Array.prototype.slice.call(arguments);Array.prototype.unshift.apply(c,d);return a.apply(b,c)}}return function(){return a.apply(b,arguments)}}
function p(a,b,c){p=Function.prototype.bind&&-1!=Function.prototype.bind.toString().indexOf("native code")?ba:ca;return p.apply(null,arguments)}function q(a,b){var c=a.split("."),d=aa;c[0]in d||!d.execScript||d.execScript("var "+c[0]);for(var e;c.length&&(e=c.shift());)c.length||void 0===b?d=d[e]?d[e]:d[e]={}:d[e]=b};function s(a,b,c,d,e,f){if(isNaN(a))throw Error("x needs to be a number");if(isNaN(b))throw Error("y needs to be a number");if(isNaN(c))throw Error("pointer must have an id");this.viewportX=a;this.viewportY=b;this.target=null;this.id=c;this.type=d;this.dragTarget=null;this.v=this.button=H.lang.isDef(e)?e:-1;this.buttons=H.lang.isDef(f)?f:0}q("H.mapevents.Pointer",s);
function t(a,b,c){if(isNaN(b))throw Error("x needs to be a number");if(isNaN(c))throw Error("y needs to be a number");a.viewportX=b;a.viewportY=c}s.prototype.va=function(){return this.v};s.prototype.getLastChangedButton=s.prototype.va;function u(a,b){a.v=b;a.buttons|=s.prototype.U[+b]||0}function v(a,b){a.v=b;a.buttons&=~(s.prototype.U[+b]||0)}s.prototype.U=[1,4,2];var x={NONE:-1,LEFT:0,MIDDLE:1,RIGHT:2};s.Button=x;function y(a){var b=a.ownerDocument,b=b.documentElement||b.body.parentNode||b.body;a=a.getBoundingClientRect();return{x:a.left+("number"===typeof window.pageXOffset?window.pageXOffset:b.scrollLeft),y:a.top+("number"===typeof window.pageYOffset?window.pageYOffset:b.scrollTop)}}var da=Function("return this")();function z(a,b,c,d,e,f,h){H.util.getSuperProto(z).constructor.call(this,a);this.pointers=b;this.changedPointers=c;this.targetPointers=d;this.currentPointer=e;this.originalEvent=h;this.target=f}H.lang.inherits(z,H.util.Event);q("H.mapevents.Event",z);function A(a){this.b=a instanceof Array?a.slice(0):[]}g=A.prototype;g.clear=function(){this.b.splice(0,this.b.length)};g.length=function(){return this.b.length};g.item=function(a){return this.b[a]};g.indexOf=function(a){for(var b=this.b.length;b--;)if(this.b[b].id===a)return b;return-1};function B(a,b){var c=a.indexOf(b);return-1!==c?a.b[c]:null}g.remove=function(a){a=this.indexOf(a);return-1!==a?this.b.splice(a,1)[0]:null};
function C(a,b){for(var c=a.b.length,d=[];c--;)a.b[c].type!==b&&d.push(a.b[c]);a.b=d}function D(a,b){for(var c=a.b.length;c--;)if(a.b[c].dragTarget===b)return!0;return!1}g.push=function(a){if(a instanceof s)return this.b.push(a);throw Error("list needs a pointer");};g.asArray=function(){return this.b};g.clone=function(){return new A(this.b)};function E(){0!=F&&(G[this[k]||(this[k]=++l)]=this)}var F=0,G={};E.prototype.Y=!1;E.prototype.dispose=function(){if(!this.Y&&(this.Y=!0,this.j(),0!=F)){var a=this[k]||(this[k]=++l);delete G[a]}};E.prototype.addOnDisposeCallback=function(a,b){this.t||(this.t=[]);this.t.push(p(a,b))};E.prototype.j=function(){if(this.t)for(;this.t.length;)this.t.shift()()};function I(a,b,c){c=c||{};if(!(a instanceof H.Map))throw Error("events: map instance required");if(!(b instanceof Array))throw Error("events: map array required");E.call(this);this.D=c.D||300;this.W=c.W||50;this.ja=c.ja||50;this.ka=c.ka||500;this.N=c.N||900;this.ba=c.ba||50;this.map=a;this.i=this.map.getViewPort();this.element=this.i.element;this.F=b;this.c=new A;this.e=new A;this.l={};this.h=null;this.u=!0;this.s={};this.r={};this.q=null;this.p=H.lang.bind(this.p,this);this.ta={pointerdown:this.qa,
pointermove:this.ra,pointerup:this.sa,pointercancel:this.pa};J(this)}H.lang.inherits(I,E);function J(a,b){for(var c,d,e=0,f=a.F.length,e=0;e<f;e++)d=a.F[e],c=d.g,"function"===typeof c&&(b?(d.target||a.element).removeEventListener(d.d,c):(d.target||a.element).addEventListener(d.d,c))}
function K(a,b,c){var d,e=a.ta[b],f,h;if("function"===typeof e)for("pointermove"!==b&&(a.u=!0),f=0,h=a.e.length();f<h;f++)b=a.e.item(f),a.element.contains(c.target)?(d=a,d=d.h===b?b.target:0<=b.viewportX&&b.viewportX<d.i.width&&0<=b.viewportY&&b.viewportY<d.i.height?d.map.getObjectAt(b.viewportX,b.viewportY)||d.map:null):d=null,L(b.id,a.s),e.call(a,b,d,c);a.e.clear()}g=I.prototype;
g.sa=function(a,b,c){a.target=b;M(this,a,c);N(this,b,"pointerup",c,a);"mouse"!==a.type&&N(this,b,"pointerleave",c,a);b=this.l[a.id];var d={x:a.viewportX,y:a.viewportY},e=c.timeStamp,f=a.target,h=this.q;b&&b.target===f&&b.B.distance(d)<this.ja&&e-b.R<this.ka?(N(this,f,"tap",c,a),h&&h.target===f&&e-h.R<this.D?h.B.distance({x:a.viewportX,y:a.viewportY})<this.W&&(N(this,f,"dbltap",c,a),this.q=null):this.q={target:f,B:new H.math.Point(a.viewportX,a.viewportY),R:c.timeStamp}):this.q=null;this.l={};L(a.id,
this.r)};function M(a,b,c){b===a.h&&(N(a,b.dragTarget,"dragend",c,b),a.h=null,L(b.id,a.s));b.dragTarget=null}g.p=function(a,b){var c=this;N(this,a.dragTarget,"drag",b,a);L(a.id,this.s);this.s[a.id]=setTimeout(function(){c.p(a,b)},150)};function L(a,b){b[a]&&(clearTimeout(b[a]),delete b[a])}
function ea(a,b,c){var d=b.target,e=new H.math.Point(b.viewportX,b.viewportY),f=b.id;L(f,a.r);a.r[f]=setTimeout(function(){d&&d===b.target&&e.distance({x:b.viewportX,y:b.viewportY})<a.ba&&(N(a,d,"longpress",c,b),delete a.l[b.id])},a.N)}
g.ra=function(a,b,c){var d=a.dragTarget,e=a.id,f;f=a.target;a.target=b;f!==b&&(N(this,f,"pointerleave",c,a),N(this,b,"pointerenter",c,a));d?this.h?this.p(a,c):this.u?this.u=!1:(this.h=a,N(this,d,"dragstart",c,a),this.p(a,c),delete this.l[e],this.u=!0):(!this.h||this.h&&this.h.dragTarget!==b&&this.h.dragTarget!==this.map)&&N(this,b,"pointermove",c,a)};
g.qa=function(a,b,c){var d=!(/^(?:mouse|pen)$/.test(a.type)&&0!==c.button),e;b&&(a.target=b,this.l[a.id]={B:new H.math.Point(a.viewportX,a.viewportY),target:a.target,R:c.timeStamp},"mouse"!==a.type&&N(this,b,"pointerenter",c,a),e=N(this,b,"pointerdown",c,a),!this.h&&d&&(b.draggable&&!D(this.c,b)?a.dragTarget=b:!this.map.draggable||e.defaultPrevented||D(this.c,this.map)||(a.dragTarget=this.map)),ea(this,a,c))};
g.pa=function(a,b,c){a.target=null;b?(N(this,b,"pointerleave",c,a),N(this,b,"pointercancel",c,a)):N(this,this.map,"pointercancel",c,a);M(this,a,c);this.l={};L(a.id,this.r)};function N(a,b,c,d,e){var f;if(b&&"function"===typeof b.dispatchEvent){f=z;var h=a.c.asArray(),m=a.e.asArray();a=a.c;var r,n=a.b.length,w=[];for(r=0;r<n;r++)a.b[r].target===b&&w.push(a.b[r]);f=new f(c,h,m,w,e,b,d);e.button=/^(?:longpress|(?:dbl)?tap|pointer(?:down|up))$/.test(c)?e.v:x.NONE;b.dispatchEvent(f)}return f}
g.j=function(){J(this,!0);this.c.clear();this.e.clear();var a=this.s,b;for(b in a)L(b,a);var a=this.r,c;for(c in a)L(c,a);this.h=this.l=this.q=this.map=this.e=this.c=this.F=null;E.prototype.j.call(this)};function O(a){var b=window;this.k=H.lang.bind(this.k,this);I.call(this,a,[{d:"mousedown",g:this.k},{d:"mousemove",g:this.k,target:b},{d:"mouseup",g:this.k,target:b},{d:"mouseover",g:this.k},{d:"mouseout",g:this.k},{d:"dragstart",g:this.w}])}H.lang.inherits(O,I);O.prototype.C=function(a,b){var c=new s(b.x,b.y,1,"mouse");this.c.push(c);return c};
O.prototype.k=function(a){var b=a.type,c=y(this.element),d={x:a.pageX-c.x,y:a.pageY-c.y},c=this.c.item(0)||this.C(a,d);this.e.push(c);t(c,d.x,d.y);/^mouse(?:move|over|out)$/.test(b)?K(this,"pointermove",a):(/^mouse(down|up)$/.test(b)&&(d=a.which-1,"up"===da.RegExp.$1?v(c,d):u(c,d)),K(this,b.replace("mouse","pointer"),a));this.e.clear()};O.prototype.w=function(a){a.preventDefault()};function P(a){this.o=H.lang.bind(this.o,this);I.call(this,a,[{d:"touchstart",g:this.o},{d:"touchmove",g:this.o},{d:"touchend",g:this.o},{d:"touchcancel",g:this.o}]);this.la={touchstart:"pointerdown",touchmove:"pointermove",touchend:"pointerup",touchcancel:"pointercancel"};this.$=(a=(a=a.getImprint())?a.getElement():null)?Array.prototype.slice.call(a.querySelectorAll("a"),0):[]}H.lang.inherits(P,I);
P.prototype.o=function(a){var b=a.touches,c=this.c.length(),d;if("touchstart"===a.type&&c>=b.length){c=this.c.clone();for(d=b.length;d--;)c.remove(b[d].identifier);for(d=c.length();d--;)this.c.remove(c.item(d).id);this.e=c;K(this,"pointercancel",a);this.e.clear()}if(this.la[a.type]){b=y(this.i.element);c=a.type;d=a.changedTouches;var e=d.length,f,h,m,r,n,w;this.e.clear();for(w=0;w<e;w++)if(m=d[w],n=B(this.c,m.identifier),f=m.pageX-b.x,h=m.pageY-b.y,n)if("touchmove"===c){if(m=Math.abs(n.viewportX-
f),r=Math.abs(n.viewportY-h),1<m||1<r||1===m&&1===r)t(n,f,h),this.e.push(n)}else"touchend"===c&&(this.c.remove(n.id),this.e.push(n),v(n,x.LEFT));else n=new s(f,h,m.identifier,"touch",x.LEFT,1),this.c.push(n),this.e.push(n);K(this,this.la[a.type],a);-1===this.$.indexOf(a.target)&&a.preventDefault()}};P.prototype.j=function(){this.$=null;I.prototype.j.call(this)};function Q(a){var b=[],b=fa(this);(navigator.pointerEnabled||navigator.msPointerEnabled)&&b.push({d:"MSHoldVisual",g:"prevent"});I.call(this,a,b)}H.lang.inherits(Q,I);function fa(a){var b=navigator.pointerEnabled,c,d,e=[];a.J=H.lang.bind(a.J,a);"MSPointerDown MSPointerMove MSPointerUp MSPointerCancel MSPointerOut MSPointerOver".split(" ").forEach(function(f){c=f.toLowerCase().replace(/ms/g,"");d=b?c:f;e.push({d:d,g:a.J,target:"MSPointerUp"===f||"MSPointerMove"===f?window:null})});return e}
var R={2:"touch",3:"pen",4:"mouse"};Q.prototype.C=function(a,b){var c;c=a.pointerType;"number"===typeof c&&(c=R[c]);c=new s(b.x,b.y,a.pointerId,c,a.button,a.buttons);this.c.push(c);return c};
Q.prototype.J=function(a){var b=navigator.ya?a.type:a.type.toLowerCase().replace(/ms/g,""),c=y(this.element),d=B(this.c,a.pointerId),e=a.pageX-c.x,c=a.pageY-c.y,f=R[a.pointerType]||a.pointerType;d||b in{pointerup:1,pointerout:1,pointercancel:1}||"touch"===f&&"pointerdown"!==b||(d=this.C(a,{x:e,y:c}));d&&(b in{pointerup:1,pointercancel:1}?("touch"===f&&this.c.remove(d.id),v(d,a.button)):"pointerdown"===b&&("touch"===a.pointerType&&(C(this.c,"mouse"),C(this.c,"pen")),u(d,a.button)),this.e.push(d),"pointermove"!==
b?(t(d,e,c),K(this,"pointerout"===b||"pointerover"===b?"pointermove":b,a)):d.viewportX===e&&d.viewportY===c||a.target===document.documentElement||(t(d,e,c),K(this,b,a)));this.e.clear()};function S(a,b,c,d,e){H.util.getSuperProto(S).constructor.call(this,"wheel");this.delta=a;this.viewportX=b;this.viewportY=c;this.target=d;this.originalEvent=e}H.lang.inherits(S,H.util.Event);q("H.mapevents.WheelEvent",S);function T(a){var b="onwheel"in document;this.oa=b;this.na=(b?"d":"wheelD")+"elta";this.K=H.lang.bind(this.K,this);H.util.getSuperProto(T).constructor.call(this,a,[{d:(b?"":"mouse")+"wheel",g:this.K}])}H.lang.inherits(T,I);T.prototype.normalize=function(a,b,c){var d=this.na,e=a[d+(d+"Y"in a?"Y":"")],f,h,m;e&&(m=Math.abs,f=m(e),e=(!(h=a[d+"X"])||3<=f/m(h))&&(!(h=a[d+"Z"])||3<=f/m(h))?((0<e)-(0>e))*(this.oa?1:-1):0);return new S(e,b,c,null,a)};
T.prototype.K=function(a){var b=y(this.element);a=this.normalize(a,a.pageX-b.x,a.pageY-b.y);a.delta&&(a.target=this.map.getObjectsAt(a.viewportX,a.viewportY)[0],a.target&&"function"===typeof a.target.dispatchEvent&&a.target.dispatchEvent(a),a.defaultPrevented||this.map.dispatchEvent(a))};function U(a,b,c,d){H.util.getSuperProto(U).constructor.call(this,"contextmenu");this.items=[];this.viewportX=a;this.viewportY=b;this.target=c;this.originalEvent=d}H.lang.inherits(U,H.util.Event);q("H.mapevents.ContextMenuEvent",U);function V(a){this.G=H.lang.bind(this.G,this);this.I=H.lang.bind(this.I,this);this.H=H.lang.bind(this.H,this);this.A=!1;this.n=-1;this.aa=0;H.util.getSuperProto(V).constructor.call(this,a,[{d:"contextmenu",g:this.G},{target:a,d:"longpress",g:this.I},{target:a,d:"dbltap",g:this.H}])}H.lang.inherits(V,I);g=V.prototype;g.I=function(a){var b=a.currentPointer;"touch"===b.type&&1===a.pointers.length&&W(this,b.viewportX,b.viewportY,a.originalEvent,a.target)};
g.H=function(a){"touch"===a.currentPointer.type&&(this.aa=Date.now())};g.G=function(a){var b=this;-1===this.n?this.n=setTimeout(function(){var c=y(b.element),d=a.pageX-c.x,c=a.pageY-c.y;b.n=-1;W(b,d,c,a)},this.D):(clearInterval(this.n),this.n=-1);a.preventDefault()};function W(a,b,c,d,e){var f=a.map;e=e||f.getObjectAt(b,c)||f;var h=Date.now()-a.aa;!a.A&&h>a.N&&(a.A=!0,e.dispatchEvent(new U(b,c,e,d)),H.util.events.listenOnce(f.getElement(),a.T,a.X,!1,a))}
g.T=["mousedown","touchstart","pointerdown","wheel"];g.X=function(){this.A&&(this.A=!1,this.map.dispatchEvent(new H.util.Event("contextmenuclose",this.map)))};g.j=function(){var a=this.map.getElement();clearInterval(this.n);a&&H.util.events.unlisten(a,this.T,this.X,!1,this);I.prototype.j.call(this)};function X(a){if(-1!==Y.indexOf(a))throw Error("InvalidArgument: map is already in use");this.a=a;Y.push(a);this.V=this.ma=this.O=this.Q=null;navigator.msPointerEnabled||navigator.pointerEnabled?this.Q=new Q(this.a):(this.Q=new P(this.a),this.O=new O(this.a));this.ma=new T(this.a);this.V=new V(this.a);this.a.addOnDisposeCallback(this.dispose,this);H.util.Disposable.call(this)}H.lang.inherits(X,H.util.Disposable);q("H.mapevents.MapEvents",X);var Y=[];
X.prototype.dispose=function(){this.a=null;this.Q.dispose();this.ma.dispose();this.V.dispose();this.O&&this.O.dispose();Y.splice(Y.indexOf(this.a),1);H.util.dispose(this)};X.prototype.dispose=X.prototype.dispose;X.prototype.ua=function(){return this.a};X.prototype.getAttachedMap=X.prototype.ua;function Z(a,b){if(-1!==$.indexOf(a))throw Error("InvalidArgument: events are already used");var c=b||{},d;H.util.Disposable.call(this);this.a=d=a.a;this.wa=a;$.push(a);this.a.draggable=!0;this.L=c.kinetics||{duration:600,ease:H.util.animation.ease.EASE_OUT_QUAD};this.Z=7;this.enable(c.enabled||this.Z);c=H.Map.EngineType;this.i=this.a.getViewPort();this.m=this.i.element;this.S=this.a.getViewModel();this.P=c.P2D;this.m.style.msTouchAction="none";this.m.style.za="none";d.addEventListener("dragstart",
this.w,!1,this);d.addEventListener("drag",this.ea,!1,this);d.addEventListener("dragend",this.fa,!1,this);d.addEventListener("wheel",this.ha,!1,this);d.addEventListener("dbltap",this.da,!1,this);d.addEventListener("tap",this.ga,!1,this);d.addEventListener("pointermove",this.ia,!1,this);H.util.events.listen(this.m,"contextmenu",this.ca,!1,this);a.addOnDisposeCallback(this.dispose,this)}H.lang.inherits(Z,H.util.Disposable);q("H.mapevents.Behavior",Z);var $=[];Z.prototype.f=0;Z.DRAGGING=1;
Z.WHEELZOOM=2;Z.DBLTAPZOOM=4;g=Z.prototype;g.w=function(a){var b=a.pointers,c=this.i;a=b[0];b=b[1]||{};if(this.f&1&&(c.startInteraction(17,this.L),c.interaction(a.viewportX,a.viewportY,b.viewportX,b.viewportY),this.f&2)){c=a.viewportX;a=a.viewportY;var d;this.M&&(b=this.a.getZoom(),d=Math[0>this.M?"ceil":"floor"](b),b!==d&&(this.M=null,this.zoom(b,d,c,a)))}};g.ea=function(a){var b=a.pointers[0],c=a.pointers[1]||{};this.f&1&&(this.i.interaction(b.viewportX,b.viewportY,c.viewportX,c.viewportY),a.originalEvent.preventDefault())};
g.fa=function(){this.f&1&&this.i.endInteraction(!this.L)};g.zoom=function(a,b,c,d){var e=+b-+a,f=this.a.getViewModel();if(isNaN(+a))throw Error("start zoom needs to be a number");if(isNaN(+b))throw Error("to zoom needs to be a number");0!==e&&(f.startControl(null,c,d),f.control(0,0,e/e*0.006),f.endControl(!0,function(a){a.zoom=b}))};
g.ha=function(a){var b,c,d,e;this.f&2&&(b=a.delta,c=this.a.getZoom(),e=Math[0>b?"ceil":"floor"](c-b),d=this.a,d.getEngine().type===this.P?(this.zoom(c,e,a.viewportX,a.viewportY),this.M=b):(c=this.a.getViewModel().getCameraData(),c.fov+=16*b,d.getViewModel().setCameraData(c)),a.originalEvent.preventDefault())};g.ga=function(a){a=a.currentPointer;var b=this.a.getEngine();this.P!==b.type&&(a=this.a.screenToCameraData(a.viewportX,a.viewportY),this.a.getViewModel().setCameraData(a))};
g.ia=function(a){a=a.currentPointer;this.a.getEngine().setPointer(a.viewportX,a.viewportY)};g.da=function(a){var b=a.currentPointer,c=this.a.getZoom(),d=a.currentPointer.type,e=this.a.getEngine();this.P===e.type&&(a="mouse"===d?0===a.originalEvent.button?-1:1:0<a.pointers.length?1:-1,a=Math[0>a?"ceil":"floor"](c-a),this.f&4&&this.zoom(c,a,b.viewportX,b.viewportY))};g.ca=function(a){return this.f&4?(a.preventDefault(),!1):!0};
g.dispose=function(){var a=this.a;a&&(a.draggable=!1,a.removeEventListener("dragstart",this.w,!1,this),a.removeEventListener("drag",this.ea,!1,this),a.removeEventListener("dragend",this.fa,!1,this),a.removeEventListener("wheel",this.ha,!1,this),a.removeEventListener("tap",this.ga,!1,this),a.removeEventListener("dbltap",this.da,!1,this),a.removeEventListener("pointermove",this.ia,!1,this),this.a=null);this.m&&(this.m.style.msTouchAction="",H.util.events.unlisten(this.m,"contextmenu",this.ca,!1,this),
this.m=null);this.S&&(this.S.removeEventListener("sync",this.xa,!1,this),this.S=null);this.L=this.i=null;$.splice($.indexOf(this.wa),1);H.util.dispose(this)};Z.prototype.dispose=Z.prototype.dispose;Z.prototype.disable=function(a){this.i.endInteraction(!0);a?this.f&a&&(this.f-=a,a&1&&(this.a.draggable=!1)):(this.f=0,this.a.draggable=!1)};Z.prototype.disable=Z.prototype.disable;Z.prototype.enable=function(a){a?this.f&a||(this.f+=a,a&1&&(this.a.draggable=!0)):(this.f=this.Z,this.a.draggable=!0)};
Z.prototype.enable=Z.prototype.enable;Z.prototype.isEnabled=function(a){if(isNaN(a))throw Error("behavior: number required");return!!(this.f&a)};Z.prototype.isEnabled=Z.prototype.isEnabled;var H=H||{};q("H.mapevents.buildInfo",function(){return H.util.BuildInfo.get("mapsjs-mapevents","0.10.0","14bbc8760c272e7a0601e9f1fedb0a1e28c9223a")});
}(H));