(function(ns){var H = ns;var k,aa=this;
function ba(a){var b=typeof a;if("object"==b)if(a){if(a instanceof Array)return"array";if(a instanceof Object)return b;var c=Object.prototype.toString.call(a);if("[object Window]"==c)return"object";if("[object Array]"==c||"number"==typeof a.length&&"undefined"!=typeof a.splice&&"undefined"!=typeof a.propertyIsEnumerable&&!a.propertyIsEnumerable("splice"))return"array";if("[object Function]"==c||"undefined"!=typeof a.call&&"undefined"!=typeof a.propertyIsEnumerable&&!a.propertyIsEnumerable("call"))return"function"}else return"null";else if("function"==
b&&"undefined"==typeof a.call)return"object";return b}var ca=Date.now||function(){return+new Date};function q(a,b){var c=a.split("."),d=aa;c[0]in d||!d.execScript||d.execScript("var "+c[0]);for(var e;c.length&&(e=c.shift());)c.length||void 0===b?d=d[e]?d[e]:d[e]={}:d[e]=b};function s(a,b,c,d,e,f){if(a&&b)this.setScheme(a),this.setHost(b),this.setPath(c),this.setPort(e),this.setAnchor(f),this.setQuery(d);else throw Error('Parameters "scheme" and "host" must be specified');}q("H.service.Url",s);
function da(a,b){var c=a,d=document,e,f,h,l,g=d.createElement("a");b&&(f=(e=d.getElementsByTagName("base")[0])&&e.href,h=d.head,l=e||h.appendChild(d.createElement("base")),l.href=b);g.href=c;c=g.href;b&&(e?e.href=f:h.removeChild(l));c=/(?:(\w+):\/\/)?(?:([^:]+):([^@/]*)@)?([^/:]+)?(?:[:]{1}([0-9]+))?(\/[^?#]*)?(\?[^#]+)?(#.*)?/.exec(c);e=c[1];g=c[4];f=c[5];d=c[6];h=c[7];l=c[8];!c[2]&&g&&/@/.test(g)&&(g=g.split("@")[1]);var c=g,d=d&&0<d.length?d.substr(1):"",g={},p,t;if(h)for(p=/([?&]?([^=&+]+))(=([^&]+))?/g;t=
p.exec(h);)g[decodeURIComponent(t[2])]=t[4]?decodeURIComponent(t[4]):void 0;return new s(e,c,d,g,isNaN(+f)?void 0:+f,l&&0<l.length?l.substr(1):"")}s.parse=da;s.prototype.clone=function(){return new s(this.ra,this.R,this.d,this.cloneQuery_(),this.W,this.C)};s.prototype.clone=s.prototype.clone;s.prototype.setScheme=function(a){if(!a||"string"!==typeof a)throw Error('The "scheme" parameter must be a non-empty string.');this.ra=a;return this};s.prototype.setScheme=s.prototype.setScheme;
s.prototype.getScheme=function(){return this.ra};s.prototype.getScheme=s.prototype.getScheme;s.prototype.setHost=function(a){if(!a||"string"!==typeof a||"-"===a.charAt(0)||"."===a.charAt(0)||"."===a.charAt(a.length-1))throw Error('The "host" parameter is not a valid host name.');this.R=a;return this};s.prototype.setHost=s.prototype.setHost;s.prototype.getHost=function(){return this.R};s.prototype.getHost=s.prototype.getHost;s.prototype.setPath=function(a){this.d=a||void 0;return this};
s.prototype.setPath=s.prototype.setPath;s.prototype.getPath=function(){return this.d};s.prototype.getPath=s.prototype.getPath;s.prototype.setQuery=function(a){if(a)if("object"==typeof a)this.g=a;else throw Error('Parameter "params" must be an object.');else this.g={};return this};s.prototype.setQuery=s.prototype.setQuery;s.prototype.hasQuery=function(){return!ea(this)};s.prototype.hasQuery=s.prototype.hasQuery;s.prototype.getQuery=function(){return this.g};s.prototype.getQuery=s.prototype.getQuery;
s.prototype.setPort=function(a){if(a&&isNaN(parseInt(a,10)))throw Error('Parameter "port" must be a number or undefined');this.W=+a||void 0;return this};s.prototype.setPort=s.prototype.setPort;s.prototype.getPort=function(){return this.W};s.prototype.getPort=s.prototype.getPort;s.prototype.setAnchor=function(a){this.C=a||void 0;return this};s.prototype.setAnchor=s.prototype.setAnchor;s.prototype.getAnchor=function(){return this.C};s.prototype.getAnchor=s.prototype.getAnchor;
s.prototype.mergeQuery=function(a){if("object"!==typeof a)throw Error('Parameter "other" must be an object.');var b=this.g,c;for(c in a)a.hasOwnProperty(c)&&"function"!==typeof a[c]&&(b[c]=a[c]);return this};s.prototype.mergeQuery=s.prototype.mergeQuery;s.prototype.addSubDomain=function(a){if(!a||"string"!==typeof a)throw Error('Parameter "subDomain" must be a non-empty string');"."===a.substr(a.length-1)&&(a=a.substr(0,a.length-1));return this.setHost(a+"."+this.R)};s.prototype.addSubDomain=s.prototype.addSubDomain;
s.prototype.addSubPath=function(a){if(!a||"string"!==typeof a)throw Error('Parameter "subPath" must be a non-empty string');return this.setPath((this.d?this.d+"/":"")+a)};s.prototype.addSubPath=s.prototype.addSubPath;s.prototype.toString=function(){return[this.ra+"://",this.R,this.W?":"+this.W:"",this.d||!ea(this)||this.C?"/":"",this.d?encodeURI(this.d):"",fa(this),this.C?"#"+encodeURIComponent(this.C):""].join("")};s.prototype.toString=s.prototype.toString;
s.prototype.cloneQuery_=function(){var a={},b;for(b in this.g)a[b]=this.g[b];return a};s.prototype.cloneQuery_=s.prototype.cloneQuery_;function fa(a){var b=[],c,d=a.g,e;for(c in d)d.hasOwnProperty(c)&&"function"!==typeof d[c]&&(e=a.g[c],b.push(encodeURIComponent(c)+(void 0===e?"":"="+encodeURIComponent(e))));return 0<b.length?"?"+b.join("&"):""}function ea(a){var b,c=0;for(b in a.g)if(a.g.hasOwnProperty(b)&&"function"!==typeof a.g[b]&&(c++,0<c))break;return!c};function u(a){function b(b){d.removeChild(e);p&&clearTimeout(p);delete u.pa[f];b&&a.Q&&a.Q.call(g,b)}if(!a.url||!a.D)throw Error('Parameter "options" must specify at least a URL and a callback.');if("function"!==typeof a.D)throw Error("Parmaters options.callback must be a function");var c=a.Yb||document,d=c.getElementsByTagName("head")[0],e=c.createElement("script"),c=a.url instanceof s?a.url:da(a.url,a.Xb),f=u.Rb++,h=a.aa||"callback",l=a.D,g={},p=null;g.id=f;g.cancel=function(){b("cancelled")};0!==
a.timeout&&(p=setTimeout(function(){b("timeout")},a.timeout||3E4));u.pa[f]=function(a){b();l.call(g,a)};e.type="text/javascript";e.src=c.toString()+(c.hasQuery()?"&":"?")+h+"="+(a.Ua?"H.service.jsonp.handleResponse("+f+")":encodeURI("H.service.jsonp.handleResponse("+f+")"));d.appendChild(e);return g}q("H.service.jsonp",u);u.Hb=function(a){return(a=u.pa[a])?a:function(){}};u.handleResponse=u.Hb;u.Rb=0;u.pa={};function v(a){a=a||{};this.k=a.subDomain;this.d=a.path;this.kb=a.callbackKey;this.e=a.baseUrl}q("H.service.AbstractRestService",v);v.prototype.c=function(a,b,c,d,e){this.b=(e||this.e).clone();this.k&&this.b.addSubDomain(this.k);this.d&&this.b.setPath(this.d);c&&this.b.setScheme("https");return this};v.prototype.configure=v.prototype.c;v.prototype.getUrl=function(){return this.b};
function w(a,b,c,d){if("function"!=ba(c))throw Error("onResult callback needed");if("function"!=ba(d))throw Error("onError callback needed");return u({url:b,D:function(a){c(a)},Q:function(a){d(Error("["+a+"] "+b+" request failed"))},aa:a.kb})};function x(a){a=y(A,a);this.Za(a.baseUrl);this.sa(a.useCIT);this.ta(a.useHTTPS);ga(this,a.app_id,a.app_code);this.bb={}}q("H.service.Platform",x);function ga(a,b,c){a.Ha=b;a.Ga=c;a.e.mergeQuery({app_id:b,app_code:c})}x.prototype.c=function(a){if(a.configure)return a.configure(this.Ha,this.Ga,this.eb,this.cb,this.e);throw Error("Object is not configurable");};x.prototype.configure=x.prototype.c;x.prototype.ta=function(a){this.eb=a;this.e.setScheme(a?"https":"http")};x.prototype.setUseHTTPS=x.prototype.ta;
x.prototype.sa=function(a){this.cb=a;this.e.setHost((a?"cit.":"")+this.ib)};x.prototype.setUseCIT=x.prototype.sa;x.prototype.Za=function(a){this.ib=a.getHost();this.e=a=a.clone();a.mergeQuery({xnlp:"CL_JSMv3."+H.buildInfo().version});this.sa(this.cb);this.ta(this.eb);ga(this,this.Ha,this.Ga)};x.prototype.setBaseUrl=x.prototype.Za;x.prototype.wb=function(){return this.e};x.prototype.getBaseUrl=x.prototype.wb;var A={app_id:null,app_code:null,useHTTPS:!1,useCIT:!1,baseUrl:new s("http","api.here.com")};
q("H.service.setOptions",function(a,b){A[a]=b});q("H.service.getOptions",function(a){return A[a]});function y(a,b){var c={},d;for(d in a)!a.hasOwnProperty(d)||d in c||(c[d]=a[d]),b&&b.hasOwnProperty(d)&&(c[d]=b[d]);return c};function B(a){a=y(A.places,a);a.callbackKey="callback";H.util.getSuperProto(B).constructor.call(this,a)}H.lang.inherits(B,v);q("H.service.PlacesService",B);B.EntryPoint={SEARCH:"discover/search",SUGGEST:"suggest",EXPLORE:"discover/explore",AROUND:"discover/around",HERE:"discover/here",CATEGORIES:"categories/places"};B.prototype.t=function(a,b,c,d){b=b||{};a=this.getUrl().clone().addSubPath(a).mergeQuery(b);return w(this,a,c,d)};B.prototype.request=B.prototype.t;
B.prototype.search=function(a,b,c){return this.t("discover/search",a,b,c)};B.prototype.search=B.prototype.search;B.prototype.Ub=function(a,b,c){return this.t("suggest",a,b,c)};B.prototype.suggest=B.prototype.Ub;B.prototype.rb=function(a,b,c){return this.t("discover/explore",a,b,c)};B.prototype.explore=B.prototype.rb;B.prototype.hb=function(a,b,c){return this.t("discover/around",a,b,c)};B.prototype.around=B.prototype.hb;B.prototype.Ib=function(a,b,c){return this.t("discover/here",a,b,c)};
B.prototype.here=B.prototype.Ib;B.prototype.mb=function(a,b,c){return this.t("categories/places",a,b,c)};B.prototype.categories=B.prototype.mb;B.prototype.tb=function(a,b,c,d){a=da(a);d&&a.mergeQuery(d);return w(this,a,b,c)};B.prototype.follow=B.prototype.tb;A.places={subDomain:"places",path:"places/v1"};x.prototype.Db=function(){return this.c(new B)};x.prototype.getPlacesService=x.prototype.Db;function D(a){a=y(A.trafficIncidents,a);a.callbackKey="jsoncallback";H.util.getSuperProto(D).constructor.call(this,a)}H.lang.inherits(D,v);q("H.service.TrafficIncidentsService",D);D.prototype.Qb=function(a,b,c){a=this.getUrl().clone().addSubPath("incidents.json").mergeQuery(a);return w(this,a,b,c)};D.prototype.requestIncidents=D.prototype.Qb;D.prototype.Wa=function(a,b,c,d,e,f){a=this.getUrl().clone().addSubPath(["incidents/json",c,a,b].join("/")).mergeQuery(f||{});return w(this,a,d,e)};
D.prototype.requestIncidentsByTile=D.prototype.Wa;A.trafficIncidents={subDomain:"traffic",path:"traffic/6.1"};x.prototype.Ma=function(){return this.c(new D)};x.prototype.getTrafficIncidentsService=x.prototype.Ma;function ha(a){var b=0,c,d,e=a.length;if(0===e)return b;for(c=0;c<e;c++)d=a.charCodeAt(c),b=(b<<5)-b+d,b|=0;return b}var E=Function("return this")();function ia(a,b){function c(){p=ca();e.font=l;g=Math.round(e.measureText("BESbswyMi").width);-1===f.indexOf(g)?b():3E5<p-d?b("timeout"):(t=50*++h,E.setTimeout(c,Math.min(t,d+3E5-p)))}var d=ca(),e=H.util.dummyCanvasContext,f=ja(),h=0,l="30px "+a+","+ka.join(","),g,p,t;-1!==ka.indexOf(a)?b():E.setTimeout(c,50)}
function la(a,b){function c(a){a?b(a):0===--d&&b()}var d=a.length;a.forEach(function(a){ia(a,c)})}var ka=H.lang.tokenize("monospace serif");function ja(){var a=[],b=H.util.dummyCanvasContext;ka.forEach(function(c){b.font="30px "+c;a.push(Math.round(b.measureText("BESbswyMi").width))});return a}function ma(a,b){var c=b||document,d=c.createElement("style"),e;d.appendChild(c.createTextNode(""));c.head.appendChild(d);e=d.sheet;a.forEach(function(a,b){e.insertRule(a,b)});return d}function na(){}
na.prototype.pop=function(a){this[a]||(this[a]=[]);return this[a].pop()||E.document.createElement("canvas")};na.prototype.push=function(a,b){this[b]||(this[b]=[]);this[b].push(a)};var F=new na;function oa(){this.Wb={hybrid:this.Ya,satellite:this.Ya,terrain:this.Ra,normal:this.Ra}}function pa(a){var b,c=a.boxes,d,e;this.alt=a.alt;this.label=a.label;this.min=a.minLevel;this.max=a.maxLevel;this.X=[];if(c&&(b=c.length))for(d=c[0],e=new H.geo.Rect(d[0],d[1],d[2],d[3]),this.X.push(e),this.V=new H.geo.Rect(d[0],d[1],d[2],d[3]),a=1;a<b;a++)d=c[a],e=new H.geo.Rect(d[0],d[1],d[2],d[3]),this.X.push(e),this.V.mergeRect(e,!1,this.V)}
pa.prototype.intersects=function(a,b){var c;if(a>=this.min&&a<=this.max)if((c=this.X.length)&&this.V){if(this.V.intersects(b))for(;c--;)if(this.X[c].intersects(b))return!0}else return!0;return!1};
var qa=new pa({label:"INEGI",minLevel:9,maxLevel:20,boxes:[[14.4031,-94.2111,16,-91],[32,-117.1817,32.7325,-113.1649],[17.406,-91,18,-88.7349],[28,-101,29.4004,-99.9666],[28,-103,30,-101],[24,-113,26,-97],[26,-99,26.4261,-97.5566],[15.5643,-97.9326,16,-95.2581],[16,-91,16.9491,-90.3434],[18,-107,22,-95],[16,-103,18,-91],[18,-95,20,-87],[28,-119,32,-103],[22,-111,24,-97],[18,-115,20,-109],[26,-117,28,-99]]}),ra=new pa({label:"NavInfo",minLevel:6,maxLevel:20,boxes:[[52.7754,119.9835,53.5719,126.1939],
[35.4169,77.1449,35.7754,78.5576],[17.7754,108.5576,18.7754,110.5576],[47.9285,115.4373,48.223,115.5576],[30.7754,78.5576,36.7754,79.5576],[49.7754,118.4027,50.9802,119.5576],[39.7754,120.5576,40.7754,126.5576],[28.7754,82.5576,29.7754,98.5576],[35.7754,120.5576,38.7754,121.5576],[40.7754,120.5576,42.7754,128.5576],[42.7754,115.5576,49.7754,131.5576],[45.7754,82.363,46.2212,82.5576],[49.7754,127.5576,50.7754,128.5576],[28.2004,96.2409,28.7754,97.5576],[18.7754,108.5576,20.7754,111.5576],[28.6334,
93.5576,28.7754,94.0161],[25.1912,119.5576,25.7754,119.912],[24.7754,117.5576,25.7754,119.5576],[38.7754,120.5576,39.7754,124.5576],[20.7754,99.5576,21.7754,102.5576],[32.7754,120.5576,33.5701,120.8986],[41.7754,128.5576,42.7754,131.5576],[27.6769,91.7865,27.7754,92.1101],[36.7754,73.5576,40.7754,79.5576],[20.7754,106.5576,22.7754,113.5576],[27.7754,117.5576,29.7754,122.5576],[45.7754,82.5576,47.7754,91.5576],[48.7754,86.6922,49.2494,88.1056],[41.7754,79.2585,41.8535,79.5576],[42.7754,111.5576,45.7754,
115.5576],[21.7754,113.5576,22.7754,116.5576],[32.2241,78.3965,32.6363,78.5576],[42.7754,94.5576,44.7754,96.5576],[29.7754,120.5576,32.7754,122.5576],[26.7754,117.5576,27.7754,121.5576],[24.5027,118.5576,24.7754,118.8161],[29.7754,122.5576,31.7754,123.5576],[40.7754,76.5576,41.7754,79.5576],[29.7754,79.5576,42.7754,120.5576],[49.7754,119.5576,52.7754,127.5576],[21.7754,98.5576,22.7754,104.5576],[47.7754,85.4858,48.7754,90.1507],[44.8404,131.5576,48.4334,134.8631],[27.7754,84.5576,28.7754,93.5576],
[25.7754,117.5576,26.7754,120.5576],[36.7754,121.5576,37.7754,123.5576],[27.2614,88.7706,27.7754,89.2653],[23.7754,97.5576,28.7754,98.5576],[35.7754,75.5576,36.7754,78.5576],[23.7754,117.5576,24.7754,118.5576],[22.7754,98.5576,29.7754,117.5576],[42.7754,79.5576,45.7754,94.5576]]});oa.prototype.Ra=[qa,ra];oa.prototype.Ya=[new pa({label:"DigitalGlobe",minLevel:0,maxLevel:20,boxes:[[90,-180,-90,180]]}),qa,ra];function sa(a,b,c,d,e,f){var h=this;f=f?f:{};var l=a.getUrl().clone().addSubPath(b+"/"+a.j+"/"+c).mergeQuery(f),g=a.f;H.map.provider.ImageTileProvider.call(this,{tileSize:d,max:512==d?19:20,min:512==d?2:0,getURL:function(a,b,c){var f=h.tileBaseUrl_.clone();g&&f.addSubDomain(g[(c+b+a)%g.length]);f.addSubPath(c+"/"+a+"/"+b+"/"+d+"/"+e);return f.toString()},crossOrigin:"anonymous"});this.service_=a;this.tileBaseUrl_=l;this.tileType_=b;this.scheme_=c;this.params_=f;this.copyrightKey_=c.split(".")[0];
this.updateAndReload_=H.lang.bind(this.updateAndReload_,this);a.addEventListener("versionupdate",this.updateAndReload_)}H.lang.inherits(sa,H.map.provider.ImageTileProvider);sa.prototype.getCopyrights=function(a,b){var c=this.service_.getCopyrights().Wb[this.copyrightKey_],d,e=c?c.length:0,f=[];for(d=0;d<e;d++)c[d].intersects(b,a)&&f.push(c[d]);return f};
sa.prototype.updateAndReload_=function(){var a=this.service_;this.tileBaseUrl_=a.getUrl().clone().addSubPath(this.tileType_+"/"+a.j+"/"+this.scheme_).mergeQuery(this.params_);this.reload(!1)};function G(a){a=y(A.maptile,a);H.util.EventTarget.call(this);this.e=a.baseUrl;this.d=a.path;this.k=a.subDomain;this.f=a.shards;this.l=(this.ia=!!a.ignoreTypes)?null:a.type;this.j=a.version;this.ba=new oa;this.Va={}}H.lang.inherits(G,H.util.EventTarget);q("H.service.MapTileService",G);function I(a,b){for(var c={},d=a[b+"s"][b],e=d.length;e--;)c[d[e].id]=d[e];a[b+"s"]=c}
G.prototype.c=function(a,b,c,d,e){this.b=(this.e||e).clone();this.k&&this.b.addSubDomain(this.k);this.l&&this.b.addSubDomain(this.l);this.d&&this.b.setPath(this.d);"newest"===this.j&&this.ca();return this};G.prototype.configure=G.prototype.c;G.prototype.getUrl=function(){return this.b};G.prototype.Na=function(){return this.l};G.prototype.getType=G.prototype.Na;G.prototype.ha=function(){return this.j};G.prototype.getVersion=G.prototype.ha;G.prototype.ua=function(a){this.j=a};
G.prototype.getCopyrights=function(){return this.ba};G.prototype.getCopyrights=G.prototype.getCopyrights;G.prototype.za=function(a){a=a.response;var b;I(a,"map");I(a,"scheme");I(a,"tiletype");I(a,"format");I(a,"resolution");I(a,"language");if("newest"===this.j&&"traffic"!==this.l)for(b in a.maps)a.maps[b].hash&&a.maps[b].newest&&(this.ua(a.maps[b].hash),this.dispatchEvent("versionupdate"));this.ja=a;this.dispatchEvent("infoupdate")};
G.prototype.ca=function(){var a=this,b=this.getUrl().clone().addSubPath("info").mergeQuery({output:"json"});this.f&&b.addSubDomain(this.f[0]);u({url:b,aa:"callback_func",D:function(b){a.za(JSON.parse(b.replace(/,\s?\]/g,"]")))},Q:function(a){throw Error("["+a+"]: Could not fetch meta-info from map tile service @"+b.toString());},Ua:!0})};G.prototype.ga=function(){return this.ja};G.prototype.getInfo=G.prototype.ga;
G.prototype.F=function(a,b,c,d,e){var f;f=ha(this.getUrl().clone().addSubPath(a+"/"+this.j+"/"+b+"/"+c+"/"+d).mergeQuery(e?e:{}).toString());var h=this.Va[f];h||(h=new sa(this,a,b,c,d,e),this.Va[f]=h);return h};G.prototype.createTileProvider=G.prototype.F;G.prototype.a=function(a,b,c,d,e,f,h){a=this.F(a,b,c,d,e);return new H.map.layer.TileLayer(a,{opacity:f,dark:!!h})};G.prototype.createTileLayer=G.prototype.a;
A.maptile={type:"base",version:"newest",subDomain:"maps",path:"maptile/2.1",shards:["1","2","3","4"]};x.prototype.J=function(a){var b;b=y(A.maptile,a);var c;c=""+(b.ignoreTypes?"":b.type);c+=b.path;c+=b.subDomain;c+=b.baseUrl;c+=b.shards?b.shards.join(""):"";b=ha(c);c=this.bb[b];c||(c=this.c(new G(a)),this.bb[b]=c);return c};x.prototype.getMapTileService=x.prototype.J;function J(a,b,c,d){d=d||ta;this.n={};d.provider=a;H.map.Spatial.call(this,b,d);c&&(this.xa=c)}H.lang.inherits(J,H.map.Spatial);q("H.service.remote.Spatial",J);var ta={};J.prototype.getId=function(){return this.xa||H.map.Spatial.prototype.getId.call(this)};J.prototype.getId=J.prototype.getId;J.prototype.u=Function();J.prototype.retain=J.prototype.u;J.prototype.r=Function();J.prototype.release=J.prototype.r;function K(a,b,c){this.vb=a;c&&(this.labels=c);0<=b&&(this.Qa=b)}K.prototype.Qa=-1;var ua=new K([]);
J.prototype.getGeometry=function(a){return(this.n[a.key]||ua).vb};J.prototype.getGeometry=J.prototype.getGeometry;J.prototype.getLabels=function(a){return(this.n[a.key]||ua).labels};J.prototype.getLabels=J.prototype.getLabels;J.prototype.getHybridIdx=function(a){return(this.n[a.key]||ua).Qa};J.prototype.getHybridIdx=J.prototype.getHybridIdx;function va(){}va.prototype.parse=function(){};q("H.service.remote.IParser.prototype.parse",va.prototype.parse);function wa(a){var b;if(a)for(this.wa={},b=a.length;b--;)this.wa[a[b]]=!0;this.ab={}}var L;wa.prototype.wa={};wa.prototype.parse=function(a,b,c){var d,e,f,h,l,g;L=!1;try{c=E.JSON.parse(c)}catch(p){L=!0}if(c&&(d=c.metadata))for(e in g={spatials:[]},d){if(c=!this.wa[e]&&(f=xa[e]))(h=d[e])||(L=!0,h=void 0),c=h;if(c)for(c=h.length;c--;){var t;(t=h[c])||(L=!0,t=void 0);(l=t)&&f(b,a,this,e,l,g)}}else L=!0;return L?void 0:g};q("H.service.metaInfo.Parser.prototype.parse",wa.prototype.parse);
var xa={"street labels":function(a,b,c,d,e,f){var h;(h=e.vertices)||(L=!0,h=void 0);if(h){var l,g=h.length,p,t;(p=0<g)||(L=!0,p=void 0);if(p)for(l=Array(g/2);g;)t=h[--g],p=h[--g],l[g/2]=new H.math.Point(p,t);l=l?[l]:[];g=+e["font size"]/a.getPixelRatio();h=c.ab[g];h||(ya.lineWidth=g,h=c.ab[g]=c.m.getCopy(ya));za(a,b,l,!1,h,e,d,f,-1)}delete e.vertices},"city center labels":function(a,b,c,d,e,f){za(a,b,Aa(e,[]),!0,c.m,e,d,f,-1)},labels:function(a,b,c,d,e,f){var h;(h=e["bounding boxes"])||(L=!0,h=void 0);
if(h){for(var l=h.length,g=[],p;l--;){var t;(t=h[l])||(L=!0,t=void 0);(p=t)&&Aa(p,g)}za(a,b,g,!0,c.m,e,d,f,-1)}delete e["bounding boxes"]},buildings:function(a,b,c,d,e,f){var h=e.id,l=b.s[h],g,p,t,n,r,m,z=[],C=[];(g=e.sectors)||(L=!0,g=void 0);if(g)for(t=g.length,p=0;p<t;p++)if((n=g[p])||(L=!0,n=void 0),n){if(r=n.vertices)(m=n.polygons)&&z.push.apply(z,Ba(r,m)),(m=n.outlines)&&C.push.apply(C,Ba(r,m));delete n.vertices;delete n.polygons;delete n.outlines}m=z.length;z.push.apply(z,C);(C=z.length)||
(L=!0,C=void 0);C&&(l?(l.n[a.key]=new K(z,m,void 0),f.spatials.push(l)):(l=za(a,b,z,!0,c.m,e,d,f,m,h),b.addObject(l)))}};xa["transit stops"]=xa.POIs=xa.labels;function Ca(a){var b=a[0],c=a[1],d=a[2];a=a[3];return[new H.math.Point(b,c),new H.math.Point(b+d,c),new H.math.Point(b+d,c+a),new H.math.Point(b,c+a)]}var Da=["text box","bullet box","annotation box","icon box"];function Aa(a,b){for(var c=Da.length,d,e;c--;)if(d=Da[c],e=a[d])b.push(Ca(e)),delete a[d];return b}
function Ba(a,b){var c=b.length,d,e,f,h,l;if(0<c)for(e=Array(c);c--;)if((d=b[c])||(L=!0,d=void 0),d&&(h=d.length,0<h))for(e[c]=f=Array(h);h--;)l=2*d[h],f[h]=new H.math.Point(a[l],a[l+1]);return e||[]}var Ea={};function za(a,b,c,d,e,f,h,l,g,p){Ea.style=e;d=new J(b,d,p,Ea);d.n[a.key]=new K(c,g,void 0);Fa(f);f.category=h;d.setData(f);l.spatials.push(d);d.setParentEventTarget(b);return d}wa.prototype.m=new H.map.SpatialStyle({strokeColor:"transparent",fillColor:"transparent",lineWidth:0});var ya={};
function Fa(a){var b,c=!1;switch(typeof a){case "object":if(a instanceof Array)for(b=a.length;b--;)Fa(a[b])?c=!0:delete a[b];else if(a)for(b in a)Fa(a[b])?c=!0:delete a[b];break;case "number":c=!0;break;default:c=!!a}return c};function Ga(){}Ga.prototype.u=function(){};q("H.service.remote.IObject.prototype.retain",Ga.prototype.u);Ga.prototype.r=function(){};q("H.service.remote.IObject.prototype.release",Ga.prototype.r);function M(a,b){var c={};this.Ta=a;H.lang.extend(c,b||c);H.map.provider.ObjectProvider.call(this,c);this.s={};Ha(this)}H.lang.inherits(M,H.map.provider.ObjectProvider);q("H.service.remote.ObjectProvider",M);function Ha(a){a=a.getInvalidations(H.map.Object.Type.SPATIAL);a.update(a.getMark()+1,H.map.provider.Invalidations.Flag.ADD)}var Ia=[];M.prototype.requestMarkers=function(){return Ia};M.prototype.requestMarkers=M.prototype.requestMarkers;M.prototype.requestDomMarkers=function(){return Ia};
M.prototype.requestDomMarkers=M.prototype.requestDomMarkers;M.prototype.providesSpatials=function(){return!0};M.prototype.providesSpatials=M.prototype.providesSpatials;M.prototype.requestSpatials=function(){return Ia};M.prototype.requestSpatials=M.prototype.requestSpatials;M.prototype.requestSpatialsByTile=function(a){var b=a.Ca,c;!b&&(c=a.Ba)&&(delete a.Ba,c=this.Ta.parse(this,a,c))&&(b=a.Ca=c.spatials);return b||Ia};M.prototype.requestSpatialsByTile=M.prototype.requestSpatialsByTile;
M.prototype.addObject=function(a){var b=a.getId();if(this.s[b])throw"Remote object "+b+" allready added";return this.s[b]=a};M.prototype.removeObject=function(a){delete this.s[a.getId()]};function N(a){a=y(A.maptile,a||{});H.util.EventTarget.call(this);this.e=a.baseUrl;this.d=a.path;this.k=a.subDomain;this.f=a.shards;this.l=(this.ia=!!a.ignoreTypes)?null:a.type;this.j=a.version;this.ba=new oa}H.lang.inherits(N,H.util.EventTarget);q("H.service.metaInfo.Service",N);function O(a,b){for(var c={},d=a[b+"s"][b],e=d.length;e--;)c[d[e].id]=d[e];a[b+"s"]=c}
N.prototype.c=function(a,b,c,d,e){this.b=(this.e||e).clone();this.k&&this.b.addSubDomain(this.k);this.l&&this.b.addSubDomain(this.l);this.d&&this.b.setPath(this.d);"newest"===this.j&&this.ca();return this};N.prototype.configure=N.prototype.c;N.prototype.getUrl=function(){return this.b};N.prototype.Na=function(){return this.l};N.prototype.ha=function(){return this.j};N.prototype.getVersion=N.prototype.ha;N.prototype.ua=function(a){this.j=a};N.prototype.getCopyrights=function(){return this.ba};
N.prototype.getCopyrights=N.prototype.getCopyrights;N.prototype.za=function(a){a=a.response;var b;O(a,"map");O(a,"scheme");O(a,"tiletype");O(a,"format");O(a,"resolution");O(a,"language");if("newest"===this.j&&"traffic"!==this.l)for(b in a.maps)a.maps[b].hash&&a.maps[b].newest&&(this.ua(a.maps[b].hash),this.dispatchEvent("versionupdate"));this.ja=a;this.dispatchEvent("infoupdate")};
N.prototype.ca=function(){var a=this,b=this.getUrl().clone().addSubPath("info").mergeQuery({output:"json"});this.f&&b.addSubDomain(this.f[0]);u({url:b,aa:"callback_func",D:function(b){a.za(JSON.parse(b.replace(/,\s?\]/g,"]")))},Q:function(a){throw Error("["+a+"]: Could not fetch meta-info from map tile service @"+b.toString());},Ua:!0})};N.prototype.ga=function(){return this.ja};N.prototype.getInfo=N.prototype.ga;N.prototype.F=function(a,b,c,d){return new P(this,d,{tileSize:a,pixelRatio:b,categoryFilter:c})};
N.prototype.createTileProvider=N.prototype.F;N.prototype.a=function(a,b,c,d){a=this.F(a,b,c,d);return new H.map.layer.TileLayer(a)};N.prototype.createTileLayer=N.prototype.a;x.prototype.Ka=function(a){return this.c(new N(a))};x.prototype.getMetaInfoService=x.prototype.Ka;A.metainfotile={type:"base",version:"newest",subDomain:"maps",path:"maptile/2.1",shards:["1","2","3","4"]};function P(a,b,c){c=c||{};this.g=b=b||{};if(!(a&&a instanceof N))throw Error("InvalidArgument: service required");this.i=a;this.ya=H.lang.bind(this.ya,this);this.i.addEventListener("versionupdate",this.ya);this.e=a.getUrl().clone().addSubPath("maptile/"+a.j+"/normal.day").mergeQuery(this.Fa).mergeQuery(b);this.f=a.f||null;this.L=c.pixelRatio||c.pixelratio||1;this.tileSize=c.tileSize||256;this.Aa=0;this.objectProvider_=new M(new wa(c.categoryFilter));this.objectProvider_.setParentEventTarget(this);
this.q=H.lang.bind(this.q,this);this.objectProvider_.addEventListener("update",this.q);this.K=H.lang.bind(this.K,this);this.o=this.getCache();H.map.provider.RemoteTileProvider.call(this,{min:0,max:20})}H.lang.inherits(P,H.map.provider.RemoteTileProvider);q("H.service.metaInfo.TileProvider",P);P.prototype.K=function(a,b){var c,d,e;c=b.getObjects();for(d=c.length;d--;)e=c[d],delete e.n[b.key],e.r();b.data&&(F.push(b.releaseCanvas(),this.tileSize),b.releaseData())};P.prototype.q=function(){this.dispatchEvent("update")};
P.prototype.requestInternal=function(a,b,c,d,e){var f=this.e.clone(),h=this.f,l=this.tileSize,g=this.getTileKey(a,b,c),g=this.o.get(g),p,t;if(g&&!g.isCanvasValid())d(F.pop(this.tileSize),null),p={cancel:function(){}};else{h&&f.addSubDomain(h[(c+b+a)%h.length]);f.addSubPath(c+"/"+a+"/"+b+"/"+l+"/png8");var n=E.setTimeout(function(){t=new H.net.Xhr(f.toString(),function(a,b){b?e():d(null,a)})},500)}return p||{cancel:function(){t||E.clearTimeout(n)}}};P.prototype.requestInternal=P.prototype.requestInternal;
P.prototype.createTileInternal=function(a,b,c,d,e){var f=this.objectProvider_,h;h=d||F.pop(this.tileSize);if(d)a=this.o.get(this.getTileKey(a,b,c)),a.render(d);else if(d=a=new H.map.provider.SpatialTile(this.getTileKey(a,b,c),a,b,c,this.tileSize,this.L,c+this.Aa,f),delete d.Ca,d.Ba=e,a.render(h))for(e=a.getObjects(),h=e.length;h--;)e[h].u();else F.push(h,this.tileSize);return a};P.prototype.createTileInternal=P.prototype.createTileInternal;
P.prototype.ya=function(){var a=this.i;this.e=a.getUrl().clone().addSubPath("maptile/"+a.j+"/normal.day").mergeQuery(this.Fa).mergeQuery(this.g);this.reload(!1)};P.prototype.Fa={metadata:"metaonly",mgen:"2"};function Ja(){this.S={}}Ja.prototype.getIcon=function(a,b){var c=a+b,d,e,f;if(!(d=this.S[c])){f={size:{w:26,h:32},anchor:{x:13,y:30}};if("CLOSURE"!==a)switch(d=Ka,a){case "CONGESTION":d=d.replace("{{icon}}",La);break;case "ROADWORKS":d=d.replace("{{icon}}",Ma);break;case "ACCIDENT":d=d.replace("{{icon}}",Na);break;default:d=d.replace("{{icon}}",Pa)}else d=Qa,f.anchor.y=16;e=Ra[b]||Ra.BLOCKING;d=d.replace("{{color}}",e);this.S[c]=d=new H.map.Icon(d,f)}return d};
var Ra={BLOCKING:"#323232",VERYHIGH:"#d5232f",HIGH:"#ffa100"},La='<path d="m 18,15 0,0 c 0,-0.1 0,-0.2 0,-0.4 l 0,-0.2 c 0,-0.1 0,-0.2 0,-0.4 0,0 0,0 0,0 0.6,0 1.1,-0.4 1.1,-1 0,-0.5 -0.5,-1 -1,-1 -0.7,0 -1.1,0.5 -1.1,1 -0.1,0 -0.3,-0.1 -0.4,-0.1 l -0.6,0 -0.3,-0.5 C 15.2,11.6 14.3,11 13.3,11 L 18,11 17.2,9.6 C 17,9.3 16.7,9 16.3,9 L 12.8,9 C 12.4,9 12,9.3 11.8,9.6 L 11.1,11 9.8,11 C 9.7,11 9.6,11 9.5,11 9.2,11 9,10.9 9,10.6 L 9,10.4 C 9,10.2 9.2,9.9 9.5,9.9 l 1.2,0 0.6,-1.04 c 0.3,-0.5 0.9,-0.9 1.5,-0.9 l 3.5,0 c 0.6,0 1.2,0.4 1.5,0.9 l 0.6,1.04 1.2,0 c 0.2,0 0.4,0.3 0.4,0.5 l 0,0.2 c 0,0.3 -0.2,0.5 -0.4,0.5 l -0.1,0 c 0.3,0.3 0.5,0.7 0.5,1.1 l 0,3.4 c 0,0.2 -0.2,0.4 -0.4,0.4 l -1.1,0 C 18.3,16 18,15.8 18,15.6 L 18,15 z M 8,18.1 c 0.6,0 1.1,-0.5 1.1,-1.1 0,-0.5 -0.5,-1 -1.1,-1 -0.6,0 -1.1,0.5 -1.1,1 0,0.6 0.5,1.1 1.1,1.1 m 7,0 c 0.6,0 1.1,-0.5 1.1,-1.1 0,-0.5 -0.5,-1 -1.1,-1 -0.5,0 -1,0.5 -1,1 0,0.6 0.5,1.1 1,1.1 M 14.2,13.6 C 14,13.3 13.7,13 13.3,13 L 9.8,13 C 9.4,13 9,13.3 8.8,13.6 L 8.1,15 15,15 14.2,13.6 z m -8.2,1 0,-0.2 c 0,-0.2 0.2,-0.5 0.5,-0.5 l 1.1,0 0.7,-1 C 8.6,12.4 9.2,12 9.8,12 l 3.5,0 c 0.6,0 1.2,0.4 1.5,0.9 l 0.6,1 1.2,0 c 0.2,0 0.4,0.3 0.4,0.5 l 0,0.2 c 0,0.3 -0.2,0.5 -0.4,0.5 l -0.1,0 c 0.3,0.3 0.5,0.7 0.5,1.1 l 0,3.4 c 0,0.2 -0.2,0.4 -0.4,0.4 l -1.1,0 C 15.3,20 15,19.8 15,19.6 L 15,19 8,19 8,19.6 C 8,19.8 7.8,20 7.5,20 l -1,0 C 6.2,20 6,19.8 6,19.6 l 0,-3.4 c 0,-0.4 0.2,-0.8 0.6,-1.1 l -0.1,0 C 6.2,15.1 6,14.9 6,14.6" fill="#ffffff" />',
Ma='<path d="m 9.24,13.2 -3.7,6.8 1.3,0 2.8,-5.1 1.36,1.5 0,3.6 1.1,0 0,-4 -1.4,-1.6 -1.46,-1.2 z M 14.2,9.5 c 0.7,0 1.3,-0.5 1.3,-1.21 0,-0.7 -0.6,-1.2 -1.3,-1.2 -0.7,0 -1.2,0.5 -1.2,1.2 0,0.71 0.5,1.21 1.2,1.21 m -4.46,0.5 1.06,0 -0.96,2.1 -1,-0.8 0.9,-1.3 z m 2.56,4 -1,-0.7 1,-1.9 0,2.6 z m 6.9,1.7 c -0.4,-0.5 -1.5,-1.1 -2.3,0 -0.2,0.3 -0.6,0.7 -0.9,1.2 l -2.7,-2.1 0,-5 -0.8,-0.7 -3.26,0 -1.5,2.3 7.86,6 C 14.7,18.6 13.8,20 13.8,20 l 6,0 1.5,-1.6 c 0,0 -1.7,-2.2 -2.1,-2.7" fill="#ffffff" />',Na=
'<path d="m 10.2,15.9 c 0.4,-0.5 1,-0.5 1.4,0 0.5,0.4 0.5,1 0,1.4 -0.4,0.4 -1,0.4 -1.4,0 -0.45,-0.4 -0.45,-1 0,-1.4 m 4.9,-5 c 0.4,-0.4 1.1,-0.4 1.5,0 0.4,0.4 0.4,1.1 0,1.5 -0.4,0.4 -1.1,0.4 -1.5,0 -0.4,-0.4 -0.4,-1.1 0,-1.5 m 2.6,3.8 c 0.1,0.3 0,0.7 -0.3,1 l -1.9,1 c 0,0 0,0.8 0,1.1 0,0.3 0,0.2 -0.1,0.3 -0.1,0.1 -0.3,0.2 -0.5,0.2 l -2.6,-0.3 4.9,-4.9 0.5,1.6 z m -6.5,5 0.1,0.2 c 0.2,0.1 0.5,0.1 0.7,0 l 0.8,-0.9 1.8,0.1 c 1.1,0 1.4,0 1.7,-0.6 l 0.1,-1.3 1.8,-0.8 c 0.4,-0.4 0.6,-1.1 0.4,-1.7 l -0.3,-1.1 0.8,-0.8 c 0.2,-0.2 0.2,-0.5 0,-0.7 L 19,12 c -0.2,-0.2 -0.5,-0.2 -0.7,0 l -0.1,0.1 c 0.1,-0.5 -0.1,-0.9 -0.4,-1.3 L 15.5,8.44 C 15.3,8.26 15,8.26 14.8,8.44 l -0.7,0.74 c -0.2,0.19 -0.2,0.49 0,0.68 l 0.3,0.34 -4.92,5 -0.36,-0.4 C 8.93,14.6 8.63,14.6 8.45,14.8 L 7.7,15.6 c -0.18,0.1 -0.18,0.4 0,0.6 l 2.4,2.4 c 0.3,0.3 0.7,0.4 1.2,0.4 l -0.1,0.1 c -0.2,0.2 -0.2,0.5 0,0.7 m 5.6,-0.8 3.9,0 1.6,-2 -5.5,2 z m -8.08,0 -3.28,-1.8 0.9,1.8 2.38,0 z" fill="#ffffff" />',
Pa='<path d="m 12.9,15.1 c 0.6,0 1.1,-0.5 1.1,-1 l 0.4,-5.9 c 0,-0.6 -0.6,-1.04 -1.5,-1.04 -0.8,0 -1.4,0.44 -1.4,1.04 l 0.3,5.9 c 0,0.5 0.6,1 1.1,1 m 0,1.3 c -0.7,0 -1.3,0.6 -1.3,1.3 0,0.8 0.6,1.4 1.3,1.4 0.8,0 1.4,-0.6 1.4,-1.4 0,-0.7 -0.6,-1.3 -1.4,-1.3" fill="#ffffff" />',Ka='<svg width="26" height="32" xmlns="http://www.w3.org/2000/svg"><path d="m 16.8,29.4 c 0,-1.1 -1.8,-2 -4,-2 -2.2,0 -4.01,0.9 -4.01,2 0,1.1 1.81,2 4.01,2 2.2,0 4,-0.9 4,-2" style="fill:#878787"/><path d="m 24.1,17.8 c 1.6,-1.6 1.6,-3.8 0,-5.7 L 15.8,1.9 C 15,0.998 14,0.498 12.9,0.498 11.8,0.498 10.7,1.1 10,1.9 L 1.7,12.1 c -1.6,1.9 -1.6,4.1 0,5.7 L 12.9,29 24.1,17.8 z" stroke="#fff" stroke-width="1" fill="{{color}}" />{{icon}}</svg>',
Qa='<svg width="26" height="32" xmlns="http://www.w3.org/2000/svg"><circle cx="13" cy="15" r="11" fill="{{color}}" stroke="#ffffff" stroke-width="1"/><rect x="6" y="13" width="14" height="5" fill="#ffffff" /></svg>';function Sa(a,b,c){c=c?c:{criticality:"major,critical"};if(!(a instanceof D))throw Error("IllegalArgument: service");this.oa=H.lang.bind(this.oa,this);H.map.provider.MarkerTileProvider.call(this,{max:20,min:8,requestData:this.oa});this.S=new Ja;this.i=a;this.g=c;this.reload=H.lang.bind(this.reload,this);setInterval(this.reload,b||18E4)}H.lang.inherits(Sa,H.map.provider.MarkerTileProvider);q("H.service.TrafficIncidentsProvider",Sa);
Sa.prototype.ob={minor:"HIGH","low impact":"HIGH",major:"VERYHIGH",critical:"BLOCKING"};
Sa.prototype.oa=function(a,b,c,d,e){var f=this,h=this.ob,l=this.S;return this.i.Wa(a,b,c,function(a){var b=[];a=a.TRAFFIC_ITEMS;var c,e,r,m;if(a)for(a=a.TRAFFIC_ITEM,m=a.length;m--;){c=a[m];e=c.TRAFFIC_ITEM_TYPE_DESC;switch(e){case "ACCIDENT":case "CONGESTION":r=e;break;case "CONSTRUCTION":r="ROADWORKS";break;default:r="OTHER"}r=l.getIcon(r,h[c.CRITICALITY.DESCRIPTION]);e=c.LOCATION.GEOLOC.ORIGIN;e=new H.map.Marker({lat:e.LATITUDE,lng:e.LONGITUDE},{provider:f,icon:r});e.setData(c);b.push(e)}d(b)},
e,this.g)};function Ta(a,b,c,d,e,f,h,l){this.Z=[];this.T={};H.map.provider.SpatialTile.call(this,a,b,c,d,e,f,h,l)}H.lang.inherits(Ta,H.map.provider.SpatialTile);Ta.prototype.ea=function(){return this.Z};function Q(a,b){H.map.Group.call(this,Ua(a));this.O={};this.xa=b;a.addObject(this)}H.lang.inherits(Q,H.map.Group);q("H.service.venues.Venue",Q);Q.prototype.G=function(a){return this.O[a]};Q.prototype.getBuilding=Q.prototype.G;Q.prototype.ea=function(){return this.O};Q.prototype.getBuildings=Q.prototype.ea;Q.prototype.addBuilding=function(a){this.O[a.getId()]=a;this.addObject(a)};Q.prototype.getId=function(){return this.xa};Q.prototype.getId=Q.prototype.getId;function R(a,b,c,d){H.map.Group.call(this,Ua(a));this.N=c;this.M=d;this.floorsByLevel_={};this.uid=b;this.p=0}H.lang.inherits(R,H.map.Group);q("H.service.venues.Building",R);R.prototype.getId=function(){return this.uid};R.prototype.getId=R.prototype.getId;R.prototype.Oa=function(){return this.getParentGroup()};R.prototype.getVenue=R.prototype.Oa;R.prototype.Cb=function(){return this.N};R.prototype.getMinLevel=R.prototype.Cb;R.prototype.Bb=function(){return this.M};R.prototype.getMaxLevel=R.prototype.Bb;
R.prototype.v=function(){return this.p};R.prototype.getCurrentLevel=R.prototype.v;R.prototype.A=function(a){var b,c,d;if(!isNaN(a)&&(b=this.N,c=this.M,a!==this.p))for(this.p=a;b<=c;b++)(d=this.floorsByLevel_[b])&&d.setVisibility(b===a);return this.p};R.prototype.I=function(a){return this.floorsByLevel_[a]};R.prototype.getFloor=R.prototype.I;R.prototype.gb=function(a,b){this.N=Math.min(this.N,a);this.M=Math.max(this.M,b)};R.prototype.adjustMinMaxLevels=R.prototype.gb;function S(a,b,c,d){J.call(this,a,!0,b);d&&(this.isFloorSpace_=d);this.setData(c)}H.lang.inherits(S,J);q("H.service.venues.Space",S);S.prototype.isFloorSpace_=!1;S.prototype.Mb=function(){return this.isFloorSpace_};S.prototype.isFloorSpace=S.prototype.Mb;S.prototype.Kb=function(a){a&&(this.Lb=new H.map.SpatialStyle(a))};S.prototype.initLabelStyle=S.prototype.Kb;S.prototype.I=function(){var a=this.getParentGroup();return this.isFloorSpace_?a:a&&a.getParentGroup()};S.prototype.getFloor=S.prototype.I;
S.prototype.referenceCounter_=0;S.prototype.u=function(){++this.referenceCounter_};S.prototype.retain=S.prototype.u;S.prototype.r=function(){var a=--this.referenceCounter_,b;a||(b=this.I(),this.isFloorSpace_?b.floorSpace_&&(b.removeObject(b.floorSpace_),b.floorSpace_=null,Va(b)):(delete b.va[this.getId()],b.floorSpaces.removeObject(this),Va(b)));return 1>a};S.prototype.release=S.prototype.r;function T(a,b,c){H.map.Group.call(this,Ua(a));this.da=c;this.floorSpace_=new S(a,b.id,b,!0);this.addObject(this.floorSpace_);this.floorSpaces=new H.map.Group(Ua(a));this.addObject(this.floorSpaces);this.va={}}H.lang.inherits(T,H.map.Group);q("H.service.venues.Floor",T);T.prototype.zb=function(){return this.da};T.prototype.getLevel=T.prototype.zb;T.prototype.fa=function(){return this.floorSpace_};T.prototype.getFloorSpace=T.prototype.fa;T.prototype.Gb=function(){return this.floorSpaces};
T.prototype.getSpaces=T.prototype.Gb;T.prototype.G=function(){return this.getParentGroup()};T.prototype.getBuilding=T.prototype.G;T.prototype.getData=function(){return this.floorSpace_&&this.floorSpace_.getData()};T.prototype.getData=T.prototype.getData;T.prototype.setData=function(a){this.floorSpace_.setData(a);return this};T.prototype.setData=T.prototype.setData;T.prototype.La=function(a){return this.va[a]};T.prototype.getSpace=T.prototype.La;
function Va(a){if(!a.floorSpaces.getChildCount()&&!a.floorSpace_){var b=a.G(),c=a.da;c===b.p&&(b.p=0);delete b.floorsByLevel_[c];b.removeObject(a);b.getChildCount()||(a=b.Oa(),delete a.O[b.getId()],a.removeObject(b),a.getChildCount()||a.getProvider().removeObject(a))}};function Wa(){}var Xa;Wa.prototype.fb=Math.PI/180;function Ya(a,b){return a&&a.category&&a.category[b||"id"]}function Za(a){var b,c;return a.sort(function(a,e){b=a.object.type;c=e.object.type;return b>c?-1:b<c?1:0})}
Wa.prototype.parse=function(a,b,c,d){var e=d.floorLevel,f=d.onSpaceCreated;d=d.styler;var h=[],l,g,p,t,n,r,m,z,C,Oa={};Xa=!1;c=c.replace(/''( )?/g,'$1\\"');try{c=E.JSON.parse(c)}catch(ob){Xa=!0}if(c.length)for(c=Za(c),l=c.length;l--;){g=c[l];p=g.area;n=p.length;z=m=r=void 0;(m=0<n)||(Xa=!0,m=void 0);if(m)for(r=Array(n/2);n;)z=p[--n],m=p[--n],r[n/2]=new H.math.Point(m,z);p=r?[r]:[];g=g.object;C=null;if(1!==g.type)switch(g.type.replace("/polygon","")){case "floor":n=r=g.buildingId;(m=a.s[n])||(m=new Q(a,
n),m.setParentEventTarget(a));z=g.buildingMinLevel;C=g.buildingMaxLevel;(n=m.G(r))?n.adjustMinMaxLevels(z,C):(n=new R(a,r,z,C),m.addBuilding(n),n.A(a.v()));r=b;m=n;0>r.Z.indexOf(m)&&r.Z.push(m);(r=n.I(e))?(n=r.fa(),p=n.getGeometry(b).concat(p)):(m=r=new T(a,g,e),z=m.da,m.setVisibility(z===n.p),n.floorsByLevel_[z]=m,n.addObject(m),n=r.fa(),f&&f(n),m=Ya(r.getData(),"profileKey"),C=d.getStyle(m,void 0),n.setStyle(C.floor));Oa[g.id]=r;0>h.indexOf(n)&&h.push(n);n.n[b.key]=new K(p,-1,void 0);break;case "space":if(t=
g.id,r=Oa[/_d$/.test(g.outerAreaId)?g.outerAreaId:g.outerAreaId+"_d"])n=r.La(t),m=Ya(r.getData(),"profileKey"),z=Ya(n?n.getData():g),n||(C=n=new S(a,t,g),r.va[C.getId()]=C,r.floorSpaces.addObject(C),C=d.getStyle(m,z),n.setStyle(C.space),f&&f(n)),n.u(),(g=g.label)&&g.firstLinePos?(C=C||d.getStyle(m,z),r=n.Lb,g=[{lines:H.lang.tokenize(g.text,"\n"),angle:g.rotation*this.fb,font:g.font.face,size:g.font.size,lineHeight:g.font.lineHeight,color:r&&r.fillColor||C.spaceLabel.fillColor,x:g.firstLinePos[0],
y:g.firstLinePos[1]}]):g=null,h.push(n),n.n[b.key]=new K(p,-1,g)}}else Xa=!0;return Xa?void 0:{spatials:h}};q("H.service.venues.Parser.prototype.parse",Wa.prototype.parse);function U(a,b,c){M.call(this,b,c);this.i=a;this.responseQueue_=[];$a(this.i)||(this.U=H.lang.bind(this.U,this),this.i.addEventListener("statechange",this.U));this.f=a.f;this.P=0;this.na={onSpaceCreated:c&&c.onSpaceCreated,floorLevel:0,styler:null};ab(this)}H.lang.inherits(U,M);U.prototype.Ob=function(a,b,c,d){this.qa?this.Sa.apply(this,arguments):d||this.responseQueue_.push({Vb:a,response:c,sb:b});d&&(a.T[b]=!0)};function bb(a){return a.getVisibility(!0)}
U.prototype.requestSpatialsByTile=function(a,b,c){var d=a.getObjects();b&&(d=d.filter(bb));if(!c){b=this.P;var e,f,h,l;if(!a.T[b]&&$a(this.i)){e=this.i.getUrl();c=a.x;f=a.y;l=h=a.z;for(var g=1,p;l--;)p=1<<l,g*=4,g+=(c&p&&1)|(f&p&&2);l=g.toString(4).substr(1);e=e.clone().addSubPath("0/tiles-ia").addSubPath("L"+b).addSubPath(l+".json");this.f&&e.addSubDomain(this.f[(c+f+h)%this.f.length]);new H.net.Request("text/plain",e.toString(),H.lang.bind(this.Ob,this,a,b));a.T[b]=!0}a.T[this.P]=!0}a.B&&(d=d.concat(a.B),
delete a.B);return d};q("H.service.venues.ObjectProvider.prototype.requestSpatialsByTile",U.prototype.requestSpatialsByTile);k=U.prototype;k.A=function(a){var b,c,d;for(b in this.s)for(c in d=this.s[b].ea(),d)d[c].A(a);Ha(this);this.dispatchUpdate();this.P=a};k.v=function(){return this.P};k.Sa=function(a,b,c,d){if(!d&&(this.na.floorLevel=b,b=(b=this.Ta.parse(this,a,c,this.na))&&b.spatials))for(a.B=a.B?a.B.concat(b):b,a=b.length;a--;)b[a].invalidate(H.map.provider.Invalidations.Flag.ADD)};
k.U=function(){$a(this.i)&&(cb(this),this.i.removeEventListener("statechange",U.prototype.U))};function cb(a){$a(a.i)&&a.qa&&a.dispatchEvent("reload")}function ab(a){db(a,function(b,c){c?a.dispatchEvent("error"):(a.na.styler=b,eb(a,H.lang.bind(a.Nb,a)))})}k.Nb=function(a){a?this.dispatchEvent("error"):(this.responseQueue_.forEach(function(a){this.Sa(a.Vb,a.sb,a.response)},this),this.responseQueue_=null,this.qa=!0,cb(this))};k.qa=!1;
function db(a,b){new H.net.Request("application/json",a.i.$a.clone().addSubPath("styles/styles.json").toString(),function(a,d){b(d?null:new fb(a),d)})}var gb=0;
function eb(a,b){var c=a.i.$a.clone().addSubPath("fonts"),d=document,e=[],f,h=[];2===gb?b():(hb.forEach(function(a){h.push("nokiapuretext{name}_rg-webfont".replace("{name}",a))}),1!==gb&&(hb.forEach(function(a,b){f=c.clone().addSubPath(h[b]);e.push('@font-face {font-family: "nokiapuretext{name}_rg-webfont";src: url("{url}.woff2") format("woff2"),url("{url}.woff") format("woff"),url("{url}.ttf") format("truetype");font-weight: normal;font-style: normal;}'.replace(/\{name\}/g,a).replace(/\{url\}/g,
f.toString()))}),a.Ja=ma(e,d),gb=1),la(h,function(c){gb=c?0:2;c&&a.Ja&&H.util.removeNode(a.Ja);b(c)}))}var hb=H.lang.tokenize("inn2 dflt in insl as me");function V(a,b){var c=b||{};if(!(a&&a instanceof W))throw Error("InvalidArgument: service required");this.K=H.lang.bind(this.K,this);this.o=this.getCache();this.objectProvider_=new U(a,new Wa,{min:this.Ea,max:this.Da,onSpaceCreated:c.onSpaceCreated});this.objectProvider_.setParentEventTarget(this);this.q=H.lang.bind(this.q,this);this.objectProvider_.addEventListener("update",this.q);this.ma=H.lang.bind(this.ma,this);this.objectProvider_.addEventListener("reload",this.ma);this.la=H.lang.bind(this.la,
this);this.objectProvider_.addEventListener("error",this.la);this.L=c.pixelRatio||c.pixelratio||1;this.tileSize=256;this.Aa=H.map.provider.TileProvider.getZoomLevelOffset(this.tileSize,this.L);H.map.provider.RemoteTileProvider.call(this,{min:this.Ea,max:this.Da})}H.lang.inherits(V,H.map.provider.RemoteTileProvider);q("H.service.venues.TileProvider",V);k=V.prototype;k.Ea=16;k.L=1;k.Da=20;k.q=function(){this.dispatchEvent("update")};k.la=function(){this.dispatchEvent("error")};k.ma=function(){this.reload(!0)};
k.K=function(a,b){var c,d,e;c=b.getObjects();for(e=c.length;e--;)d=c[e],delete d.n[b.key],d.r();b.data&&F.push(b.releaseCanvas(),this.tileSize);b.releaseData()};k.A=function(a){this.objectProvider_.A(a)};V.prototype.setCurrentLevel=V.prototype.A;V.prototype.v=function(){return this.objectProvider_.v()};V.prototype.getCurrentLevel=V.prototype.v;V.prototype.requestInternal=function(a,b,c,d){var e;this.o.get(this.getTileKey(a,b,c))?d(null,null):e=E.setTimeout(function(){d(null,null)},500);return{cancel:function(){E.clearTimeout(e)}}};
V.prototype.requestInternal=V.prototype.requestInternal;V.prototype.createTileInternal=function(a,b,c){var d=F.pop(this.tileSize),e=this.o.get(this.getTileKey(a,b,c));e||(e=new Ta(this.getTileKey(a,b,c),a,b,c,this.tileSize,this.L,c+this.Aa,this.objectProvider_));e.render(d)||F.push(d,this.tileSize);return e};V.prototype.createTileInternal=V.prototype.createTileInternal;function fb(a){this.lb=a;this.m=this.H("general","default")||ib;this.o=new H.util.Cache(200)}fb.prototype.ka=function(a,b){for(var c,d,e,f,h=1;h<arguments.length;h++)for(c in d=arguments[h],d)if(d.hasOwnProperty(c))for(e in a[c]||(a[c]={}),f=d[c],f)f.hasOwnProperty(e)&&void 0!==f[e]&&(a[c][e]=f[e]);return a};fb.prototype.getStyle=function(a,b){var c=this.H("spaceToGroup",b);return jb(this,a,c?c+"":void 0)};
function jb(a,b,c){var d,e,f;f=(b?b+"_":"")+(c?c:"default");d=a.m;(e=a.o.get(f))?d=e:(b&&c?(d=jb(a,b,void 0),e=jb(a,void 0,c),b=a.H("venues",b,"groups",c),d=a.ka({},a.m,d,e,b)):b&&!c?d=a.ka({},a.m,a.H("venues",b,"default")):!b&&c&&(d=a.ka({},a.m,a.H("general","groups",c))),a.o.add(f,d,1));return d}fb.prototype.H=function(a){for(var b=this.lb,c=arguments,d=c.length,e=0;e!==d;)if(b=b[c[e++]],!b)return;return b};
var ib={space:{fillColor:"rgba(198, 175, 255, .7)",strokeColor:"rgb(162, 141, 216)",lineWidth:0.5},spaceLabel:{fillColor:"rgb(78,66,111)"},floor:{fillColor:"rgba(249, 244, 253, .7)",strokeColor:"rgba(255, 255, 255, .7)",lineWidth:1}};function W(a){var b=A.venues;a=y(b,a||{});H.util.EventTarget.call(this);this.e=b.baseUrl;this.d=a.path;this.k=a.subDomain;this.f=b.shards}H.lang.inherits(W,H.util.EventTarget);q("H.service.venues.Service",W);var X={ERROR:-1,INIT:0,READY:1};W.State=X;
W.prototype.c=function(a,b,c,d,e){this.b=(this.e||e).clone();this.$a=this.b.clone().addSubDomain("js").addSubPath("statics/venues").setQuery();this.k&&this.b.addSubDomain(this.k);this.l&&this.b.addSubDomain(this.l);this.d&&this.b.setPath(this.d);a=A.venueSignature;b=this.b.clone();b.addSubDomain(a.subDomain);b.addSubPath(a.path);b.addSubPath(a.version);this.Tb=b;this.qb=this.b.clone();this.Y===X.INIT&&this.Ia();return this};W.prototype.configure=W.prototype.c;function $a(a){return a.Y===X.READY}
W.prototype.getUrl=function(){return $a(this)?this.b:void 0};W.prototype.Ia=function(){var a=this;new H.net.Request("application/json",this.Tb.toString(),function(b,c){if(c)kb(a,X.ERROR,c);else{var d=b.SignatureTokens,e=new Date(b.Expires),f=e?e.getTime()-ca()-36E5:0;a.b.mergeQuery(d);e&&4E9>f&&E.setTimeout(H.lang.bind(a.Ia,a),Math.max(f,0));kb(a,X.READY)}})};
W.prototype.pb=function(a,b,c){var d=A.venuesDiscovery;a=this.qb.clone().addSubDomain(d.subDomain).addSubPath(d.path).addSubPath(d.version).mergeQuery(y(a,d.params));new H.net.Request("application/json",a.toString(),function(a,d){d?c(d):b(a)})};W.prototype.discover=W.prototype.pb;W.prototype.a=function(a){return new H.map.layer.TileLayer(new V(this,a))};W.prototype.createTileLayer=W.prototype.a;W.prototype.Y=X.INIT;W.prototype.getState=function(){return this.Y};W.prototype.getState=W.prototype.getState;
function kb(a,b,c){var d=new H.util.Event("statechange",a);c&&(d.errorCode=c);a.Y=b;a.dispatchEvent(d)}x.prototype.Pa=function(a){return this.c(new W(a))};x.prototype.getVenueService=x.prototype.Pa;var lb={subDomain:"venue.maps",path:"",shards:H.lang.tokenize("1 2 3 4").map(function(a){return"static-"+a})};A.venues=lb;A.venueSignature={version:"v1",subDomain:"signature",path:"venues/signature"};A.venuesDiscovery={version:"v1",subDomain:"discovery",path:"venues/discovery"};var mb={};function Ua(a){mb.provider=a;return mb};x.prototype.nb=function(a,b,c,d,e,f){var h=this.J(),l=this.J({type:"aerial"}),g=this.J({type:"traffic"}),p=this.J({type:"pano"}),t=this.Ka(),n=this.Ma(),r=this.Pa(),m={};a=a||256;var z=320===b?2:1;320===b&&(m.ppi=b);c&&(m.lg=c);d&&(m.lg2=d);e&&(m.style=e);f&&(m.pois="");b=new Sa(n,void 0,c?m:null);this.Jb=new H.map.layer.MarkerTileLayer(b);return{normal:{xbase:h.a("xbasetile","normal.day",a,"png8",m,1,!1),base:h.a("basetile","normal.day",a,"png8",m,1,!1),map:h.a("maptile","normal.day",a,"png8",m,
1,!1),traffic:g.a("traffictile","normal.day",a,"png8",m,1,!1),transit:h.a("maptile","normal.day.transit",a,"png8",m,1,!1),panorama:p.a("rctile","normal.day",a,"png8",m,1,!1),labels:h.a("labeltile","normal.day",a,"png",m,1,!1),metaInfo:t.a(a,z,["buildings"],m)},satellite:{xbase:l.a("xbasetile","hybrid.day",a,"jpg",m,1,!0),base:l.a("basetile","hybrid.day",a,"jpg",m,1,!0),map:l.a("maptile","hybrid.day",a,"jpg",m,1,!0),traffic:g.a("traffictile","hybrid.day",a,"jpg",m,1,!0),panorama:p.a("rctile","hybrid.day",
a,"jpg",m,1,!0),labels:l.a("labeltile","hybrid.day",a,"png",m,1,!0)},terrain:{xbase:l.a("xbasetile","terrain.day",a,"jpg",m,1,!1),base:l.a("basetile","terrain.day",a,"jpg",m,1,!1),map:l.a("maptile","terrain.day",a,"jpg",m,1,!1),traffic:g.a("traffictile","terrain.day",a,"jpg",m,1,!1),panorama:p.a("rctile","terrain.day",a,"jpg",m,1,!1),labels:l.a("labeltile","terrain.day",a,"png",m,1,!1)},incidents:this.Jb,venues:r.a({tileSize:a,pixelRatio:z})}};x.prototype.createDefaultLayers=x.prototype.nb;function Y(a){a=y(A.enterpriseRouting,a);a.callbackKey="jsoncallback";if(!H.lang.isInstanceOf(a.baseUrl,s))throw new H.lang.InvalidArgumentError(Y,0,"Invalid base url");this.Pb=a;H.util.getSuperProto(Y).constructor.call(this,a)}H.lang.inherits(Y,v);q("H.service.EnterpriseRoutingService",Y);Y.prototype.$=function(a,b,c){a=this.getUrl().clone().addSubPath("calculateroute.json").mergeQuery(a);w(this,a,b,c)};Y.prototype.calculateRoute=Y.prototype.$;
Y.prototype.Eb=function(a,b,c){a=this.getUrl().clone().addSubPath("getroute.json").mergeQuery(a);w(this,a,b,c)};Y.prototype.getRoute=Y.prototype.Eb;Y.prototype.Ab=function(a,b,c){a=this.getUrl().clone().addSubPath("getlinkinfo.json").mergeQuery(a);w(this,a,b,c)};Y.prototype.getLinkInfo=Y.prototype.Ab;Y.prototype.jb=function(a,b,c){a=this.getUrl().clone().addSubPath("calculateisoline.json").mergeQuery(a);w(this,a,b,c)};Y.prototype.calculateIsoline=Y.prototype.jb;
Y.prototype.c=function(a,b,c,d,e){var f,h=A.enterpriseRouting;this.Pb.baseUrl===h.baseUrl&&e&&(f=e.clone(),f.setHost(h.host),d&&f.addSubDomain(h.citSubDomain));return v.prototype.c.apply(this,[a,b,c,d,f])};Y.prototype.configure=Y.prototype.c;var nb={subDomain:"route",path:"routing/6.2",baseUrl:new s("http","nlp.nokia.com"),host:"nlp.nokia.com",citSubDomain:"st"};A.enterpriseRouting=nb;x.prototype.xb=function(a){return this.c(new Y(a))};x.prototype.getEnterpriseRoutingService=x.prototype.xb;function Z(a){a=y(A.routing,a);a.callbackKey="jsoncallback";H.util.getSuperProto(Z).constructor.call(this,a)}H.lang.inherits(Z,v);q("H.service.RoutingService",Z);Z.prototype.$=function(a,b,c){a=this.getUrl().clone().addSubPath("calculateroute.json").mergeQuery(a);w(this,a,b,c)};Z.prototype.calculateRoute=Z.prototype.$;A.routing={subDomain:"route",path:"routing/7.2"};x.prototype.Fb=function(a){return this.c(new Z(a))};x.prototype.getRoutingService=x.prototype.Fb;function $(a){a=y(A.geocoding,a);a.callbackKey="jsoncallback";H.util.getSuperProto($).constructor.call(this,a);this.Xa=a.reverseSubDomain}H.lang.inherits($,v);q("H.service.GeocodingService",$);$.prototype.ub=function(a,b,c){a=this.getUrl().clone().addSubPath("geocode.json").mergeQuery(a);return w(this,a,b,c)};$.prototype.geocode=$.prototype.ub;$.prototype.Sb=function(a,b,c){a=this.getUrl().clone().addSubPath("reversegeocode.json").mergeQuery(a);this.Xa&&a.addSubDomain(this.Xa);return w(this,a,b,c)};
$.prototype.reverseGeocode=$.prototype.Sb;$.prototype.search=function(a,b,c){a=this.getUrl().clone().addSubPath("search.json").mergeQuery(a);return w(this,a,b,c)};$.prototype.search=$.prototype.search;A.geocoding={subDomain:"geocoder",path:"6.2",reverseSubDomain:"reverse"};x.prototype.yb=function(a){return this.c(new $(a))};x.prototype.getGeocodingService=x.prototype.yb;var H=H||{};q("H.service.buildInfo",function(){return H.util.BuildInfo.get("mapsjs-service","0.10.0","1ee7c070dbfdd759d3d7d1a4bbfa957472f215d4")});
}(H));